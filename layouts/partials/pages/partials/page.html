{{ $page := .page }}
{{- $class := "page" -}}
{{- $custom_class := "" -}}
{{- $heading := .Scratch.Get "heading" | default "h2" -}}
{{ $options := .options }}
{{- if .Params.bodyclass -}}
  {{ $class = printf "%s page-%s" $class .Params.bodyclass }}
{{- end -}}

{{ with $page }}
  {{- if .Scratch.Get "class" -}}
    {{ $custom_class = .Scratch.Get "class" }}
    {{ $class = printf "%s %s" $class $custom_class }}
  {{- end -}}
  <article class="{{ $class }}">
    <div class="page-content">
      {{- partial "PrepareHTML" (printf "<%s class='page-title'>" $heading) -}}
        <a href="{{ .Permalink }}">
          {{- partial "PrepareHTML" .Title -}}
        </a>
      {{- partial "PrepareHTML" (printf "</%s>" $heading) -}}

      {{- partial "pages/partials/page/hook-after-title.html" . -}}

      {{ if and $options.categories .Params.taxonomies }}
        {{ partial "commons/categories" ( dict
          "context" .
          "kind" "page"
        )}}
      {{ end }}

      {{- with and $options.summary  .Params.summary }}
        {{ . | safeHTML }}
      {{ end -}}
    </div>
    {{ if $options.image }}
      {{- partial "pages/partials/page/page-media.html" . -}}
    {{- end -}}
  </article>
{{ end }}