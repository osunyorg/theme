{{ $content := partial "GetTextFromHTML" .context.Params.content }}
{{ $presentation :=  partial "GetTextFromHTML" .context.Params.presentation }}
{{ $objectives :=  partial "GetTextFromHTML" .context.Params.objectives }}
{{ $pedagogy :=  partial "GetTextFromHTML" .context.Params.pedagogy }}
{{ $evaluation :=  partial "GetTextFromHTML" .context.Params.evaluation }}
{{ $teachers := .context.Params.teachers }}

{{ $opportunities := partial "GetTextFromHTML" .context.Params.opportunities }}
{{ $results := partial "GetTextFromHTML" .context.Params.results }}

{{ $prerequisites := partial "GetTextFromHTML" .context.Params.prerequisites }}
{{ $pricing := partial "GetTextFromHTML" .context.Params.pricing }}
{{ $registration := partial "GetTextFromHTML" .context.Params.registration }}
{{ $accessibility := partial "GetTextFromHTML" .context.Params.accessibility }}
{{ $other := partial "GetTextFromHTML" .context.Params.other }}

{{ $certification := .context.Params.certifications.qualiopi.certified  }}

{{ $roles := .context.Params.roles }}
{{ $contacts := partial "GetTextFromHTML" .context.Params.contacts }}

{{ $category := site.GetPage (printf "/posts_categories/%s" .context.Params.related_category ) }}
{{ $related_posts := $category.Pages }}

{{/* nav-link required for toggle active class */}}
<nav class="toc" id="nav-toc" aria-label="{{ i18n "commons.toc" }}">
  <ol>
    <li>
      <a href="#{{ urlize (i18n "programs.toc.essential") }}">{{ i18n "programs.toc.essential" }}</a>
    </li>
    <li>
      <a href="#{{ urlize (i18n "programs.toc.presentation") }}">{{ i18n "programs.toc.presentation" }}</a>
       <ol>
          {{- if $presentation -}}
            <li><a href="#{{ urlize (i18n "programs.presentation") }}">{{ i18n "programs.presentation" }}</a></li>
          {{- end -}}
          {{- if $objectives -}}
            <li><a href="#{{ urlize (i18n "programs.objectives") }}">{{ i18n "programs.objectives" }}</a></li>
          {{- end -}}
          <li><a href="#{{ urlize (i18n "programs.administrative_information") }}">{{ i18n "programs.administrative_information" }}</a></li>
          {{- if .context.Params.contents -}}
            {{- partial "blocks/toc" .context.Params.contents -}}
          {{- end -}}
        </ol>
    </li>
    <li>
      <a href="#{{ urlize (i18n "programs.toc.pedagogy") }}">{{ i18n "programs.toc.pedagogy" }}</a>
      {{- if or $content $pedagogy $evaluation $teachers }}
      <ol>
        {{- if $content -}}
          <li><a href="#{{ urlize (i18n "programs.content") }}">{{ i18n "programs.content" }}</a></li>
        {{- end -}}
        {{- if $pedagogy -}}
          <li><a href="#{{ urlize (i18n "programs.pedagogy") }}">{{ i18n "programs.pedagogy" }}</a></li>
        {{- end -}}
        {{- if $evaluation -}}
          <li><a href="#{{ urlize (i18n "programs.evaluation") }}">{{ i18n "programs.evaluation" }}</a></li>
        {{- end -}}
        {{- if $teachers -}}
          <li><a href="#{{ urlize (i18n "programs.teachers") }}">{{ i18n "programs.teachers" }}</a></li>
        {{- end -}}
      </ol>
      {{ end -}}
    </li>
    <li>
      <a href="#{{ urlize (i18n "programs.toc.results") }}">{{ i18n "programs.toc.results" }}</a>
      {{- if or $opportunities $results }}
      <ol>
        {{- if $opportunities -}}
          <li><a href="#{{ urlize (i18n "programs.opportunities") }}">{{ i18n "programs.opportunities" }}</a></li>
        {{- end -}}
        {{- if $results -}}
          <li><a href="#{{ urlize (i18n "programs.results") }}">{{ i18n "programs.results" }}</a></li>
        {{- end -}}
      </ol>
      {{ end -}}
    </li>
    <li>
      <a href="#{{ urlize (i18n "programs.toc.admission") }}">{{ i18n "programs.toc.admission" }}</a>
      {{- if or $prerequisites $pricing $registration $accessibility $other $roles $contacts }}
      <ol>
        {{- if $prerequisites -}}
          <li><a href="#{{ urlize (i18n "programs.prerequisites") }}">{{ i18n "programs.prerequisites" }}</a></li>
        {{- end -}}
        {{- if $pricing -}}
          <li><a href="#{{ urlize (i18n "programs.pricing") }}">{{ i18n "programs.pricing" }}</a></li>
        {{- end -}}
        {{- if $registration -}}
          <li><a href="#{{ urlize (i18n "programs.registration") }}">{{ i18n "programs.registration" }}</a></li>
        {{- end -}}
        {{- if $accessibility -}}
          <li><a href="#{{ urlize (i18n "programs.accessibility") }}">{{ i18n "programs.accessibility" }}</a></li>
        {{- end -}}
        {{- if $other -}}
          <li><a href="#{{ urlize (i18n "programs._other") }}">{{ i18n "programs._other" }}</a></li>
        {{- end -}}
        {{- if $roles -}}
          <li><a href="#{{ urlize (i18n "programs.roles") }}">{{ i18n "programs.roles" }}</a></li>
        {{- end -}}
        {{- if $contacts -}}
          <li><a href="#{{ urlize (i18n "programs.contacts") }}">{{ i18n "programs.contacts" }}</a></li>
        {{- end -}}
      </ol>
      {{ end -}}
    </li>
    {{- if $certification -}}
      <li>
        <a href="#{{ urlize (i18n "programs.toc.certification") }}">{{ i18n "programs.toc.certification" }}</a>
      </li>
    {{- end -}}
    {{- if gt (len $related_posts) 0 -}}
      <li>
        <a href="#{{ urlize (i18n "programs.toc.related") }}">{{ i18n "programs.toc.related" }}</a>
      </li>
    {{- end -}}
  </ol>
</nav>
