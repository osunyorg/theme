.search-button,
.pagefind-ui__button,
.search__close
    @include button-reset
    @include meta
    &:focus
        box-shadow: none
    @include meta
    color: var(--color-text)

.search__close
    @include icon-block(close-line, after)
    position: fixed
    right: $spacing-5
    padding: 0
    z-index: 9
    &::after
        display: inline-flex
        justify-content: center
        margin-left: $spacing-2
        width: pxToRem(15)
    @include media-breakpoint-down(desktop)
        right: $spacing-3
        top: $spacing-1

#search
    background: var(--color-background)
    color: var(--color-text)
    display: none
    height: 100vh
    left: 0
    padding-bottom: $spacing-5
    padding-left: var(--grid-gutter)
    padding-right: var(--grid-gutter)
    padding-top: $spacing-6
    position: fixed
    overflow: auto
    top: 0
    width: 100vw
    z-index: 80
    @include media-breakpoint-up(desktop)
        padding-top: $spacing-4
    &.is-opened
        display: block
    a
        color: var(--color-text)
    .pagefind-ui
        // Used to hide results behind search input
        &::before
            content: ""
            background: var(--color-background)
            height: space(34)
            left: 0
            position: fixed
            top: 0
            width: 100%
            z-index: 5
            @include media-breakpoint-down(desktop)
                height: space(52)
        &__form
            @include icon(search-line, after)
            &::after
                color: alphaColor(var(--color-text-alt), 0.6)
                position: fixed
                pointer-events: none
                z-index: 9
                font-size: 1.1em
                @include media-breakpoint-down(desktop)
                    right: $spacing-3
                    top: space(35)
        &__search-input
            background-color: var(--color-background)
            border-left: 0
            border-right: 0
            border-radius: 0
            border-top: 0
            color: var(--color-text)
            padding-left: 0
            padding-right: $spacing-3 !important
            position: fixed
            z-index: 6
            &:focus,
            &:focus-visible
                border-bottom: 2px solid var(--color-text)
                outline: none
        &__button[type="button"]
            @include button-reset
            @include link(var(--color-text))
            margin-top: $spacing-4
            padding: 0
        &__message
            @include meta
            color: var(--color-text-alt)
            text-align: right
            z-index: 11
            position: fixed
            top: space(27)
        &__search-clear,
        &__suppressed
            display: none
            pointer-events: none
        &__drawer
            position: relative
            @include media-breakpoint-down(desktop)
                padding-top: $spacing-2
        &__results
            &:empty
                display: none
        &__result
            list-style: none
            position: relative
            a,
            span
                white-space: pre-wrap
            &-thumb
                grid-column: 1/4
                > *
                    aspect-ratio: 3/2
                    object-fit: cover
                @include media-breakpoint-down(desktop)
                    display: none
            + li
                margin-top: $spacing-4
            @include media-breakpoint-up(desktop)
                @include grid
                &-inner
                    grid-column: 4/13
        &__result-excerpt mark
                background-color: var(--color-accent)
                color: var(--color-background)
        &__result-title a
            @include h4
            @include stretched-link
        @include media-breakpoint-up(desktop)
            &__form
                position: relative
                width: columns(8)
                &::after
                    left: calc(#{columns(8)} + #{var(--grid-gutter)})
                    top: space(16)
                    transform: translateX(-100%)
            &__search-input,
            &__message
                width: columns(8)
            &__results-area
                padding-top: $spacing-6
        @include media-breakpoint-down(desktop)
            &__search-input,
            &__message
                left: var(--grid-gutter)
                right: var(--grid-gutter)
            &__message
                top: space(46)
            &__results-area
                padding-top: space(17)

// Toggle button appareance

.search-button
    align-items: baseline
    cursor: pointer
    display: flex
    gap: $spacing-1
    padding: 0
    text-align: left
    white-space: nowrap
    line-height: 1

// Can be with icon only, text only, or both
.search-button
    align-items: center
    display: flex
    gap: $spacing-1
    justify-content: space-between
    text-align: left
    white-space: nowrap
    line-height: 1
    &::after
        line-height: inherit
    &--primary, &--upper-menu
        align-items: baseline
        color: $header-color
        @if not $search-button-header-text
            span
                @extend .sr-only
        @if $search-button-header-icon
            @include icon(search-line, after)
    &--primary
        width: 100%
    &--footer
        color: $footer-color
        padding: 0
        @if not $search-button-footer-text
            span
                @extend .sr-only
        @if $search-button-footer-icon
            @include icon(search-line, after)
    &--fixed
        background: var(--color-background-alt)
        bottom: 0
        color: var(--color-text)
        left: var(--grid-gutter)
        min-height: $minimum-accessible-size
        padding: $spacing-1 $spacing-2
        position: fixed
        z-index: $zindex-search-button-fixed
        @if not $search-button-fixed-text
            span
                @extend .sr-only
        @if $search-button-fixed-icon
            @include icon(search-line, after)
        @include media-breakpoint-down(desktop)
            left: 0
            width: 100vw
            &.in-page-with-toc
                background: var(--color-background)
                border-top: var(--border-width) solid #eee
                bottom: pxToRem(44)
                padding: 0 var(--grid-gutter)
        @include media-breakpoint-up(desktop)
            @if $search-button-fixed-text
                width: columns(2)
